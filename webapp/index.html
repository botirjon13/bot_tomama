<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Tomama Oâ€˜yini</title>

  <!-- âœ… TOâ€˜Gâ€˜RI TELEGRAM SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- FONDA HARAKATLANUVCHI POMIDORLAR -->
<div class="bg-elements">
    <img src="assaets/products/tomatoFon.png" class="floating-item item-1">
    <img src="assaets/products/tomatoFon.png" class="floating-item item-2">
    <img src="assaets/products/tomatoFon.png" class="floating-item item-3">
</div>

<!-- ================= MAIN MENU ================= -->
<div id="mainMenu" class="menu-container">
  <div class="menu-box">
      <img src="assaets/logo.png" class="game-logo" alt="Tomama Logo">

      <div id="recordBox">
          <span>Sizning rekordingiz</span><br>
          <strong id="personalBest">0</strong>
      </div>

      <button onclick="startGame()">â–¶ï¸ O'yinni boshlash</button>
      <button onclick="showRanking()">ğŸ† Reyting (Top-10)</button>
      <button onclick="showCoupons()">ğŸ« Kuponlarim</button>
  </div>
</div>

<!-- ================= RANKING ================= -->
<div id="rankingMenu" class="menu-container hidden">
  <div class="menu-box">
      <h2>ğŸ† Top-10 Reyting</h2>
      <ul id="rankingList">
          <li class="loading">Yuklanmoqda...</li>
      </ul>
      <button class="back-btn" onclick="hideRanking()">â¬…ï¸ Ortga</button>
  </div>
</div>

<!-- ================= COUPONS ================= -->
<div id="couponsMenu" class="menu-container hidden">
  <div class="menu-box">
      <h2>ğŸ« Kuponlarim</h2>
      <ul id="couponList">
          <li class="active">Hozircha kuponlar yoâ€˜q</li>
      </ul>
      <button class="back-btn" onclick="hideCoupons()">â¬…ï¸ Ortga</button>
  </div>
</div>

<!-- ================= GAME CANVAS ================= -->
<canvas id="gameCanvas" class="hidden"></canvas>

<script>
/* ================= DOM ELEMENTS ================= */
const mainMenu = document.getElementById('mainMenu');
const rankingMenu = document.getElementById('rankingMenu');
const couponsMenu = document.getElementById('couponsMenu');
const gameCanvas = document.getElementById('gameCanvas');

/* ================= TELEGRAM INIT ================= */
const tg = window.Telegram?.WebApp;
const tgUser = tg?.initDataUnsafe?.user || null;
if (tg) {
    tg.ready();
    tg.expand();
}

/* ================= PERSONAL BEST ================= */
window.addEventListener('load', () => {
    document.getElementById('personalBest').innerText =
        localStorage.getItem('highScore') || 0;
});

/* ================= MENU FUNCTIONS ================= */
function startGame() {
    mainMenu.classList.add('hidden');
    gameCanvas.classList.remove('hidden');
    if (window.startGameLoop) window.startGameLoop();
}

function showRanking() {
    mainMenu.classList.add('hidden');
    rankingMenu.classList.remove('hidden');
    if (window.loadLeaderboard) window.loadLeaderboard();
}

function hideRanking() {
    rankingMenu.classList.add('hidden');
    mainMenu.classList.remove('hidden');
}

function showCoupons() {
    mainMenu.classList.add('hidden');
    couponsMenu.classList.remove('hidden');
}

function hideCoupons() {
    couponsMenu.classList.add('hidden');
    mainMenu.classList.remove('hidden');
}
</script>

<script src="game.js"></script>
</body>
</html>
